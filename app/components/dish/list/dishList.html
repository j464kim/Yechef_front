<div class="container" id="dishList" ng-controller="SearchController as sctrl">
	<div class="col-sm-8">
		<div class="row">
			<button type="button" class="btn btn-default"
			        ng-click="DishCtrl.isSearchCollapsed = !DishCtrl.isSearchCollapsed">Refine Search
				<i class="fa fa-caret-up" aria-hidden="true" ng-if="!DishCtrl.isSearchCollapsed"></i>
				<i class="fa fa-caret-down" aria-hidden="true" ng-if="DishCtrl.isSearchCollapsed"></i>
			</button>
			<div uib-collapse="DishCtrl.isSearchCollapsed"
			     ng-init="DishCtrl.getSearchParams(sctrl)">
				<md-card>
					<md-content class="md-padding">
						<div class="col-sm-3">
							<div class="row no-gutters">
								<md-input-container>
									<input type="text" id="food" ng-model="sctrl.q">
									<label for="food">Key word (ex. Seafood)</label>
									<br/> <br/><br/>
									<md-checkbox ng-model="sctrl.deliverOnly" disabled>Deliver Only</md-checkbox>
								</md-input-container>
							</div>
						</div>
						<div class="col-sm-2">
							<div class="row no-gutters">
								<md-input-container>
									<input type="text" id="City" options="sctrl.autocompleteOptions"
									       g-places-autocomplete
									       ng-model="sctrl.city"/>
									<label for="City">City</label>
									<br/> <br/><br/>
									<md-checkbox ng-model="sctrl.gluten_free" ng-true-value="1"
									             ng-checked="sctrl.gluten_free == 1">Gluten-free
									</md-checkbox>
								</md-input-container>
							</div>
						</div>
						<div class="col-sm-3">
							<label class="col-sm-offset-2">Price Range</label>
							<div class="col-sm-6">
								<md-input-container>
									<input type="text" id="min_price" ng-model="sctrl.min_price">
									<label for="max_price">min</label>
								</md-input-container>
							</div>
							<div class="col-sm-6">
								<md-input-container>
									<input type="text" id="max_price" ng-model="sctrl.max_price">
									<label for="max_price">max</label>
								</md-input-container>
							</div>
						</div>
						<div class="col-sm-3">
							<div layout="column" ng-cloak>
								<form ng-submit="$event.preventDefault()">
									<md-autocomplete
											md-no-cache="true"
											md-selected-item="sctrl.selectedNationality"
											md-search-text="sctrl.searchText"
											md-items="item in sctrl.querySearch(sctrl.searchText, sctrl.nationalities)"
											md-item-text="item.display"
											md-min-length="0"
											placeholder="Choose Nationality">
										<md-item-template>
                                <span md-highlight-text="sctrl.searchText"
                                      md-highlight-flags="^i">{{item.display}}</span>
										</md-item-template>
										<md-not-found>
											No states matching "{{sctrl.searchText}}" were found.
											<a ng-click="sctrl.newState(sctrl.searchText)">Create a new one!</a>
										</md-not-found>
									</md-autocomplete>
									<br/><br/>
									<md-checkbox ng-model="sctrl.vegetarian" ng-true-value="1"
									             ng-checked="sctrl.vegetarian == 1">Vegetarian
									</md-checkbox>
									<md-checkbox ng-model="sctrl.vegan" ng-true-value="1" ng-checked="sctrl.vegan == 1">
										Vegan
									</md-checkbox>
								</form>
							</div>
						</div>
					</md-content>
				</md-card>
				<div class="row no-gutters">
					<div class="col-sm-push-10 col-sm-2">
						<md-button class="md-raised md-primary" ng-click="sctrl.searchDish()">Search</md-button>
					</div>
				</div>
			</div>
			<div class="row no-gutters">
				<div class="col-sm-3">
					<md-select ng-model="sctrl.sortBy" placeholder="Sort by" class="md-no-underline"
					           ng-change="sctrl.searchDish()">
						<md-option value="price_asc">Price (Ascending)</md-option>
						<md-option value="price_dsc">Price (Descending)</md-option>
						<md-option value="newest">Newest</md-option>
						<md-option value="taste">Taste</md-option>
						<md-option value="visual">Visual</md-option>
						<md-option value="quantity">Quantity</md-option>
					</md-select>
				</div>
				<div class="col-sm-3">
					<md-slider-container ng-mouseup="sctrl.searchDish()">
						<md-slider class="md-primary" flex min="0" max="100"
						           ng-model="sctrl.distance"
						           aria-label="distance"
						           id="distance-slider">
						</md-slider>
					</md-slider-container>
					<span ng-if="sctrl.distance != 0">Max Distance: {{sctrl.distance}} km</span>
					<span ng-if="sctrl.distance == 0 || sctrl.distance === undefined">Max Distance: Any</span>
				</div>
			</div>
		</div>
		<hr>
		<div class="row">
			<div class="col-md-6" ng-repeat="dish in DishCtrl.dishes" loader>
				<dish-card dish="dish"></dish-card>
			</div>
		</div>
		<hr/>
		<div class="row">
			<div class="col-md-10 col-md-offset-2">
				<ul uib-pagination total-items="DishCtrl.totalItems" ng-model="DishCtrl.currentPage" items-per-page="18"
				    boundary-links="true" force-ellipses="true" max-size="5"
				    ng-change="DishCtrl.getDishes()"></ul>
			</div>
		</div>
	</div>
	<div class="col-sm-4" id="map-dish-list" loader>
		<ui-gmap-google-map center='DishCtrl.map.center'
		                    zoom='DishCtrl.map.zoom'
		                    events="DishCtrl.mapEvents"
		                    control="DishCtrl.mapCtrl"
		                    options="DishCtrl.map.options"
		                    ng-cloak>
			<ui-gmap-markers
					models="DishCtrl.dishMapMarkers"
					coords="'self'"
					icon="'icon'">
			</ui-gmap-markers>
			<ui-gmap-circle center='DishCtrl.circle.center'
			                radius='DishCtrl.circle.radius'
			                fill='DishCtrl.circle.fill'
			                stroke='DishCtrl.circle.stroke'
			                clickable='false'>
			</ui-gmap-circle>
		</ui-gmap-google-map>
	</div>
</div>