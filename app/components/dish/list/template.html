<div class="container" id="dishList" loader>
    <div class="col-sm-8">
        <div class="row">
            <button type="button" class="btn btn-default"
                    ng-click="DishCtrl.isSearchCollapsed = !DishCtrl.isSearchCollapsed">Refine Search
                <i class="fa fa-caret-up" aria-hidden="true" ng-if="!DishCtrl.isSearchCollapsed"></i>
                <i class="fa fa-caret-down" aria-hidden="true" ng-if="DishCtrl.isSearchCollapsed"></i>
            </button>
            <div uib-collapse="DishCtrl.isSearchCollapsed" ng-controller="SearchCtrl as sctrl"
                 ng-init="DishCtrl.getSearchParams(sctrl)">
                <md-content class="md-padding">
                    <div class="col-sm-3">
                        <div class="row no-gutters">
                            <md-input-container>
                                <input type="text" id="food" ng-model="sctrl.q">
                                <label for="food">Key word (ex. Seafood)</label>
                                <br/> <br/><br/>
                                <md-checkbox ng-model="sctrl.deliverOnly" disabled>Deliver Only</md-checkbox>
                            </md-input-container>
                        </div>
                    </div>
                    <div class="col-sm-2">
                        <div class="row no-gutters">
                            <md-input-container>
                                <input type="text" id="City" options="sctrl.autocompleteOptions" g-places-autocomplete ng-model="sctrl.city" />
                                <label for="City">City</label>
                                <br/><br/>
                                <md-slider-container>
                                    <md-slider flex ng-init="sctrl.distance=0" min="0" max="10"
                                               ng-model="sctrl.distance"
                                               aria-label="distance"
                                               id="distance-slider">
                                    </md-slider>
                                </md-slider-container>
                                <span>Distance: {{sctrl.distance}} km</span>
                            </md-input-container>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <label class="col-sm-offset-2">Price Range</label>
                        <div class="col-sm-6">
                            <md-input-container>
                                <input type="text" id="min_price" ng-model="sctrl.min_price">
                                <label for="max_price">min</label>
                            </md-input-container>
                        </div>
                        <div class="col-sm-6">
                            <md-input-container>
                                <input type="text" id="max_price" ng-model="sctrl.max_price">
                                <label for="max_price">max</label>
                            </md-input-container>
                        </div>
                    </div>
                    <div class="col-sm-3">
                        <div layout="column" ng-cloak>
                            <form ng-submit="$event.preventDefault()">
                                <md-autocomplete
                                        md-no-cache="true"
                                        md-selected-item="sctrl.selectedNationality"
                                        md-search-text-change="sctrl.searchTextChange(sctrl.searchText)"
                                        md-search-text="sctrl.searchText"
                                        md-selected-item-change="sctrl.selectedItemChange(item)"
                                        md-items="item in sctrl.querySearch(sctrl.searchText)"
                                        md-item-text="item.display"
                                        md-min-length="0"
                                        placeholder="Choose Nationality">
                                    <md-item-template>
                                <span md-highlight-text="sctrl.searchText"
                                      md-highlight-flags="^i">{{item.display}}</span>
                                    </md-item-template>
                                    <md-not-found>
                                        No states matching "{{sctrl.searchText}}" were found.
                                        <a ng-click="sctrl.newState(sctrl.searchText)">Create a new one!</a>
                                    </md-not-found>
                                </md-autocomplete>
                                <br/><br/>
                                <md-checkbox ng-model="sctrl.gluten_free" ng-true-value="1"
                                             ng-checked="sctrl.gluten_free == 1">Gluten-free
                                </md-checkbox>
                                <md-checkbox ng-model="sctrl.vegetarian" ng-true-value="1"
                                             ng-checked="sctrl.vegetarian == 1">Vegetarian
                                </md-checkbox>
                                <md-checkbox ng-model="sctrl.vegan" ng-true-value="1" ng-checked="sctrl.vegan == 1">
                                    Vegan
                                </md-checkbox>
                            </form>
                        </div>
                    </div>
                </md-content>

                <div class="row no-gutters">
                    <div class="col-sm-3">
                        <md-select ng-model="sctrl.sortBy" placeholder="Sort by" class="md-no-underline" ng-init="console.log(sctrl.sortBy)">
                            <md-option ng-value="'hottest'" ng-selected="sctrl.sortBy === 'hottest'">Hottest</md-option>
                            <md-option ng-value="'price_asc'" ng-selected="sctrl.sortBy === 'price_asc'">Price
                                (Ascending)
                            </md-option>
                            <md-option ng-value="'price_dsc'" ng-selected="sctrl.sortBy === 'price_dsc'">Price
                                (Descending)
                            </md-option>
                            <md-option ng-value="'taste'" ng-selected="sctrl.sortBy === 'taste'">Taste</md-option>
                            <md-option ng-value="'visual'" ng-selected="sctrl.sortBy === 'visual'">Visual</md-option>
                            <md-option ng-value="'quantity'" ng-selected="sctrl.sortBy === 'quantity'">Quantity
                            </md-option>
                        </md-select>
                    </div>
                    <div class="col-sm-push-7 col-sm-3">
                        <md-button class="md-raised md-warn" ng-click="sctrl.searchDish()">Search</md-button>
                    </div>
                </div>
            </div>
        </div>
        <hr/>
        <div class="row">
            <div class="col-md-6" ng-repeat="dish in DishCtrl.dishes">
                <a ui-sref="dish.show({id: {{dish.id}}})">
                    <div class="row">
                        <img ng-src="{{dish.medias[0].url}}" alt="Card image cap"
                             style="width:90%;">
                    </div>
                    <div class="row">
                        <h4 class="card-title">
                            {{dish.name}}</h4>
                        <h6 class="card">${{dish.price}}</h6>
                    </div>
                </a>
            </div>
        </div>
        <hr/>
        <div class="row">
            <div class="col-md-10 col-md-offset-2">
                <!--TODO: Change items-per-page to 18-->
                <ul uib-pagination total-items="DishCtrl.totalItems" ng-model="DishCtrl.currentPage" items-per-page="18"
                    boundary-links="true" force-ellipses="true" max-size="5"
                    ng-change="DishCtrl.getDishes()"></ul>
            </div>
        </div>
    </div>

    <div class="col-sm-4" style="position: fixed; right:0; top:5; height: 100vh">
        <ui-gmap-google-map center='DishCtrl.map.center' zoom='DishCtrl.map.zoom'
                            options="DishCtrl.map.options"></ui-gmap-google-map>
    </div>
</div>